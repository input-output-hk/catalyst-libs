{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://raw.githubusercontent.com/input-output-hk/catalyst-libs/refs/heads/main/docs/src/architecture/08_concepts/signed_doc/signed_doc_defs.schema.json",
    "title": "Signed Document Definitions Database",
    "description": "Source of truth for definitions of all catalyst signed documents.",
    "maintainers": [
        {
            "name": "Catalyst Team",
            "url": "https://projectcatalyst.io/"
        }
    ],
    "x-changelog": {
        "2025-02-10": [
            "First Version Created."
        ]
    },
    "additionalProperties": false,
    "definitions": {
        "contentType": {
            "type": "string",
            "description": "The content type used for this document payload.",
            "enum": [
                "application/json",
                "application/cbor"
            ]
        },
        "contentEncoding": {
            "type": "string",
            "description": "The ways this content can be encoded.  By default all content allows for no encoding.",
            "enum": [
                "br"
            ]
        },
        "contentEncodings": {
            "type": "array",
            "description": "All content encodings allowed for this document payload.",
            "items": {
                "$ref": "#/definitions/contentEncoding"
            }
        },
        "docType": {
            "type": "string",
            "format": "uuid",
            "pattern": "^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-4[0-9A-Fa-f]{3}-[89ABab][0-9A-Fa-f]{3}-[0-9A-Fa-f]{12}$"
        },
        "docIdOrVer": {
            "description": "The ID or version of the document",
            "type": "string",
            "format": "uuid",
            "pattern": "^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{7}-4[0-9A-Fa-f]{3}-[89ABab][0-9A-Fa-f]{3}-[0-9A-Fa-f]{12}$"
        },
        "metadataFormat": {
            "type": "string",
            "enum": [
                "UUIDv7",
                "COSE Algorithm",
                "HTTP Content Type",
                "HTTP Content Encoding",
                "Document Reference",
                "Document Hash"
            ]
        },
        "requiredOrOptional": {
            "type": "string",
            "enum": [
                "yes",
                "optional",
                "no"
            ]
        },
        "metadataFieldDescription": {
            "type": "string",
            "format": "markdown"
        },
        "metadataFieldSpec": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "format": {
                    "$ref": "#/definitions/metadataFormat"
                },
                "required": {
                    "$ref": "#/definitions/requiredOrOptional"
                },
                "ref type": {
                    "type": "string"
                },
                "description": {
                    "$ref": "#/definitions/metadataFieldDescription"
                },
                "validation": {
                    "$ref": "#/definitions/metadataFieldDescription"
                }
            }
        },
        "docDefinitionFields": {
            "properties": {
                "contentType": {
                    "$ref": "#/definitions/contentType"
                },
                "contentEncodings": {
                    "$ref": "#/definitions/contentEncodings"
                },
                "metadata": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                        "id": {
                            "$ref": "#/definitions/metadataFieldSpec"
                        },
                        "ver": {
                            "$ref": "#/definitions/metadataFieldSpec"
                        },
                        "alg": {
                            "$ref": "#/definitions/metadataFieldSpec"
                        },
                        "content type": {
                            "$ref": "#/definitions/metadataFieldSpec"
                        },
                        "content encoding": {
                            "$ref": "#/definitions/metadataFieldSpec"
                        },
                        "ref": {
                            "$ref": "#/definitions/metadataFieldSpec"
                        },
                        "ref hash": {
                            "$ref": "#/definitions/metadataFieldSpec"
                        },
                        "template": {
                            "$ref": "#/definitions/metadataFieldSpec"
                        }
                    }
                }
            }
        },
        "docDefinition": {
            "$id": "docDefinition",
            "title": "Individual Document Definition",
            "description": "A single document definition",
            "type": "object"
        }
    },
    "properties": {
        "default": {
            "type": "object",
            "title": "Default Document Definition",
            "$ref": "#/definitions/docDefinitionFields",
            "required": [
                "contentType",
                "contentEncodings",
                "metadata"
            ]
        },
        "docs": {
            "type": "object",
            "title": "Document Definition",
            "patternProperties": {
                ".*": {
                    "$ref": "#/definitions/docDefinition"
                }
            },
            "required": [
                "Proposal Template",
                "Proposal",
                "Proposal Action",
                "Proposal Comment Template",
                "Proposal Comment",
                "Category Parameters",
                "Campaign Parameters",
                "Brand Parameters",
                "Public Vote Tx V2",
                "Private Vote Tx V2",
                "Immutable Ledger Block"
            ]
        }
    }
}